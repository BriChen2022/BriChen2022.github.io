<!DOCTYPE html><html lang="cn" theme-mode="light"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Project 2 | BriChen's blog</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"键入以继续","blurHolder":"数据检索","noResult":"无 $0 相关数据"},"code":{"codeInfo":"$0 - 共 $1 行","copy":"复制","copyFinish":"复制成功","expand":"展开"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.1/MathJax.js"></script><script>MathJax.Hub.Config({
 menuSettings: {
   zoom: "None"
 },
 showMathMenu: false,
 jax: ["input/TeX","output/CommonHTML"],
 extensions: ["tex2jax.js"],
 TeX: {
   extensions: ["AMSmath.js","AMSsymbols.js"],
   equationNumbers: {
     autoNumber: "AMS"
   }
 },
 tex2jax: {
   inlineMath: [["\\(", "\\)"]],
   displayMath: [["\\[", "\\]"]]
 }
});</script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem"><a class="navBlock" href="/contact/"><span class="navItemTitle">Experience</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>Project 2</h1><div id="post-info"><span>文章发布时间: <div class="control"><time datetime="2022-10-11T07:57:19.000Z" id="date"> 2022-10-11</time></div></span><br><span>最后更新时间: <div class="control"><time datetime="2023-06-03T08:53:34.588Z" id="updated"> 2023-06-03</time></div></span></div></div><hr><div id="post-content"><h1 id="练习一-runge现象"><a href="#练习一-(Runge现象)" class="headerlink" title="练习一-(Runge现象)"></a>练习一 (Runge现象)</h1>
<p>(1)为用 Lagrange 插值法计算出来的函数值. <strong>代码:</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># lagrange 插值函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lagrange</span>(<span class="params">X,Y,xx</span>):</span><br><span class="line">    bas = []</span><br><span class="line">    L = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(X)):</span><br><span class="line">        bas.append(basis(X[i],xx,<span class="built_in">len</span>(X),i))</span><br><span class="line">        L=L+bas[i]*Y[i]</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">basis</span>(<span class="params">x_k,xx,<span class="built_in">len</span>,k</span>):</span><br><span class="line">    l = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>):</span><br><span class="line">        <span class="keyword">if</span> k != i:</span><br><span class="line">            l = l * ((xx-X[i])/(x_k-X[i]))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line">X = [<span class="number">2</span>,<span class="number">2.75</span>,<span class="number">4</span>] <span class="comment">#已知节点</span></span><br><span class="line">Y = [<span class="number">1</span>/<span class="number">2</span>,<span class="number">4</span>/<span class="number">11</span>,<span class="number">1</span>/<span class="number">4</span>] <span class="comment">#对应函数值</span></span><br><span class="line">xx = <span class="number">3</span> <span class="comment"># 插值点</span></span><br><span class="line"></span><br><span class="line">L=lagrange(X,Y,xx)</span><br><span class="line">L_a = <span class="number">1</span> / xx</span><br><span class="line"><span class="built_in">print</span>(L,L_a,<span class="built_in">abs</span>(L-L_a))</span><br></pre></td></tr></table></figure> <strong>输出结果:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0.3295454545454546</span> <span class="number">0.3333333333333333</span> <span class="number">0.003787878787878729</span></span><br></pre></td></tr></table></figure></p>
<p>(2)等距节点的L插值函数. <strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Runge 现象</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lagrange</span>(<span class="params">X,Y,xx</span>):</span><br><span class="line">    bas = []</span><br><span class="line">    L = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(X)):</span><br><span class="line">        bas.append(basis(X[i],xx,<span class="built_in">len</span>(X),i))</span><br><span class="line">        L=L+bas[i]*Y[i]</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">basis</span>(<span class="params">x_k,xx,<span class="built_in">len</span>,k</span>):</span><br><span class="line">    l = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>):</span><br><span class="line">        <span class="keyword">if</span> k != i:</span><br><span class="line">            l = l * ((xx-X[i])/(x_k-X[i]))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line">n = <span class="number">20</span></span><br><span class="line">h = <span class="number">10</span>/n </span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(-<span class="number">5</span>+i*h)            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 作图</span></span><br><span class="line">x = numpy.arange(-<span class="number">5</span>,<span class="number">5.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    y.append(lagrange(X,Y,x[i]))</span><br><span class="line"></span><br><span class="line">plt.plot(x, func(x))</span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<strong>输出结果:</strong>（经过很小地修改后把四幅图画在一起，为了缩短篇幅代码中没有体现）
<img src="/images/数值逼近/9381bb1b6b0045cb67c44895796c1a3f.png"
alt="9381bb1b6b0045cb67c44895796c1a3f.png" /></p>
<p>(3)Chebyshev插值节点的L插值多项式. <strong>代码:</strong>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用chebyshev节点的插值</span></span><br><span class="line"><span class="keyword">from</span> cmath <span class="keyword">import</span> cos</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lagrange</span>(<span class="params">X,Y,xx</span>):</span><br><span class="line">    bas = []</span><br><span class="line">    L = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(X)):</span><br><span class="line">        bas.append(basis(X[i],xx,<span class="built_in">len</span>(X),i))</span><br><span class="line">        L=L+bas[i]*Y[i]</span><br><span class="line">    <span class="keyword">return</span> L</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">basis</span>(<span class="params">x_k,xx,<span class="built_in">len</span>,k</span>):</span><br><span class="line">    l = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>):</span><br><span class="line">        <span class="keyword">if</span> k != i:</span><br><span class="line">            l = l * ((xx-X[i])/(x_k-X[i]))</span><br><span class="line">    <span class="keyword">return</span> l</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chebyshev_node</span>(<span class="params">i,n</span>):</span><br><span class="line">    z_i = cos((pi*(<span class="number">2</span>*i+<span class="number">1</span>))/(<span class="number">2</span>*n+<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> z_i</span><br><span class="line"></span><br><span class="line">n = <span class="number">16</span></span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(<span class="number">5</span>*chebyshev_node(i,n))            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 作图</span></span><br><span class="line">x = numpy.arange(-<span class="number">5</span>,<span class="number">5.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x)):</span><br><span class="line">    y.append(lagrange(X,Y,x[i]))</span><br><span class="line"></span><br><span class="line">plt.plot(x, func(x))</span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p><strong>输出结果:</strong> <img
src="/images/数值逼近/f17515682bbbf27a5931fce09f132c29.png"
alt="f17515682bbbf27a5931fce09f132c29.png" /> (4)Newton插值多项式.
<strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Newton 插值法</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment">#Runge函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line"><span class="comment"># 差商表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divided_difference</span>(<span class="params">X,Y,l</span>):</span><br><span class="line">    N_k1 = deepcopy(Y)</span><br><span class="line">    N_k2 = deepcopy(Y)</span><br><span class="line">    N_k3 = deepcopy(Y)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,l):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j,l):</span><br><span class="line">            N_k2[i] = (N_k1[i]-N_k1[i-<span class="number">1</span>])/(X[i]-X[i-j]) <span class="comment"># 跟着改动？？？？？</span></span><br><span class="line">        N_k3[j] = N_k2[j]</span><br><span class="line">        N_k1 = deepcopy(N_k2)</span><br><span class="line">    <span class="keyword">return</span> N_k3</span><br><span class="line"></span><br><span class="line"><span class="comment"># Newton插值多项式的Horner算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">N_interpolation_polynomial</span>(<span class="params">x,X,N_k1,n</span>):</span><br><span class="line">    <span class="built_in">sum</span> = N_k1[n]*(x-X[n-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">sum</span> =(x-X[i-<span class="number">1</span>])*(<span class="built_in">sum</span> + N_k[i])</span><br><span class="line">    <span class="built_in">sum</span> = <span class="built_in">sum</span> + N_k1[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">20</span></span><br><span class="line">h = <span class="number">10</span>/n</span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(-<span class="number">5</span>+i*h)            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line"></span><br><span class="line">XX = np.arange(-<span class="number">5</span>,<span class="number">5.01</span>,<span class="number">0.01</span>,<span class="built_in">float</span>)</span><br><span class="line">YY = []</span><br><span class="line">L = <span class="built_in">len</span>(X)</span><br><span class="line">N_k = divided_difference(X,Y,L) <span class="comment"># 牛顿差商</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> XX:</span><br><span class="line">    y = N_interpolation_polynomial(i,X,N_k,n) <span class="comment"># 插值多项式</span></span><br><span class="line">    <span class="comment">#y = Newton(i,X,Y,L-1,N_k)</span></span><br><span class="line">    YY.append(y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插值图</span></span><br><span class="line">plt.plot(XX,YY)</span><br><span class="line"><span class="comment"># 比较图</span></span><br><span class="line">plt.plot(XX, func(XX),<span class="string">&quot;r&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure></p>
<p><strong>输出结果:</strong> <img
src="/images/数值逼近/6edabd77484d33e912175282822e9839.png"
alt="6edabd77484d33e912175282822e9839.png" /> # 练习二 (分段插值)
(1)分段线性插值 <strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分段线性插值</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"></span><br><span class="line"><span class="comment"># Runge函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段插值函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">piecewise_linear_interpolation_func</span>(<span class="params">xx,X,Y,n</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + basis_func(xx,X,i)*Y[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 基函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">basis_func</span>(<span class="params">xx,X,i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">and</span> i == n:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i-<span class="number">1</span>] <span class="keyword">and</span> xx&lt;=X[i]:</span><br><span class="line">        l = (xx-X[i-<span class="number">1</span>])/(X[i]-X[i-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i] <span class="keyword">and</span> xx&lt;=X[i+<span class="number">1</span>]:</span><br><span class="line">        l = (xx-X[i+<span class="number">1</span>])/(X[i]-X[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">10</span>                           <span class="comment">#区间个数</span></span><br><span class="line">h = <span class="number">10</span>/n                        <span class="comment">#区间长度</span></span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(-<span class="number">5</span>+i*h)            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段插值图</span></span><br><span class="line">xx = numpy.arange(-<span class="number">5</span>,<span class="number">5.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">yy =[]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> xx:</span><br><span class="line">    y = piecewise_linear_interpolation_func(x,X,Y,n)</span><br><span class="line">    yy.append(y)</span><br><span class="line">plt.plot(xx,yy)</span><br><span class="line"><span class="comment"># 比较图</span></span><br><span class="line">plt.plot(xx, func(xx))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<strong>输出结果:</strong> <img
src="/images/数值逼近/5837018e2caa1681479afa359d273d0f.png"
alt="5837018e2caa1681479afa359d273d0f.png" /> (2)分段3次Hermit插值
<strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分段3次Hermit插值</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Runge函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段3次Hermit函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tri_Hermit_interpolation_func</span>(<span class="params">xx,X,Y,dY,n</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + (h_func(xx,X,i)*Y[i]+h_bar_func(xx,X,i)*dY[i])</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Hermit基函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h_func</span>(<span class="params">xx,X,i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">and</span> i == n:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i-<span class="number">1</span>] <span class="keyword">and</span> xx&lt;=X[i]:</span><br><span class="line">        l = <span class="built_in">pow</span>((xx-X[i-<span class="number">1</span>])/(X[i]-X[i-<span class="number">1</span>]),<span class="number">2</span>)*(<span class="number">2</span>*(xx-X[i])/(X[i-<span class="number">1</span>]-X[i])+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i] <span class="keyword">and</span> xx&lt;=X[i+<span class="number">1</span>]:</span><br><span class="line">        l = <span class="built_in">pow</span>((xx-X[i+<span class="number">1</span>])/(X[i]-X[i+<span class="number">1</span>]),<span class="number">2</span>)*(<span class="number">2</span>*(xx-X[i])/(X[i+<span class="number">1</span>]-X[i])+<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">h_bar_func</span>(<span class="params">xx,X,i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">and</span> i == n:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i-<span class="number">1</span>] <span class="keyword">and</span> xx&lt;=X[i]:</span><br><span class="line">        l = <span class="built_in">pow</span>((xx-X[i-<span class="number">1</span>])/(X[i]-X[i-<span class="number">1</span>]),<span class="number">2</span>)*(xx-X[i])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i] <span class="keyword">and</span> xx&lt;=X[i+<span class="number">1</span>]:</span><br><span class="line">        l = <span class="built_in">pow</span>((xx-X[i+<span class="number">1</span>])/(X[i]-X[i+<span class="number">1</span>]),<span class="number">2</span>)*(xx-X[i])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">8</span>                           <span class="comment">#区间个数</span></span><br><span class="line">h = <span class="number">10</span>/n                        <span class="comment">#区间长度</span></span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line">dY = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求导</span></span><br><span class="line">a= sp.symbols(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">b = <span class="number">1</span>/(<span class="number">1</span>+a**<span class="number">2</span>)</span><br><span class="line">db = sp.diff(b,a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(-<span class="number">5</span>+i*h)            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line">    dY.append(db.evalf(subs=&#123;a:-<span class="number">5</span>+i*h&#125;)) <span class="comment"># 节点导数值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段插值图</span></span><br><span class="line">xx = np.arange(-<span class="number">5</span>,<span class="number">5.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">yy =[]</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> xx:</span><br><span class="line">    y = tri_Hermit_interpolation_func(x,X,Y,dY,n)</span><br><span class="line">    yy.append(y)</span><br><span class="line">plt.plot(xx,yy)</span><br><span class="line"><span class="comment"># 比较图</span></span><br><span class="line">plt.plot(xx, func(xx),<span class="string">&quot;r&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure> <strong>输出结果:</strong> <img
src="/images/数值逼近/69a431e9536419b8142d002a92f6382f.png"
alt="69a431e9536419b8142d002a92f6382f.png" /> (3)三次固支样条插值
<strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 三次（固支）样条插值(三弯矩构造)</span></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">1</span>/(<span class="number">1</span>+<span class="built_in">pow</span>(x,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> y </span><br><span class="line"></span><br><span class="line"><span class="comment"># 差商表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divided_difference</span>(<span class="params">X,Y,l,k</span>):</span><br><span class="line">    N_k1 = deepcopy(Y)</span><br><span class="line">    N_k2 = deepcopy(Y)</span><br><span class="line">    N_k3 = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,k+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j,l):</span><br><span class="line">            N_k2[i] = (N_k1[i]-N_k1[i-<span class="number">1</span>])/(X[i]-X[i-j])</span><br><span class="line">        N_k1 = deepcopy(N_k2)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k,l):</span><br><span class="line">        N_k3.append(N_k1[j])</span><br><span class="line">    <span class="keyword">return</span> N_k3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 三弯矩计算M</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">M</span>(<span class="params">X,Y,H,L,n</span>):</span><br><span class="line">    M = []</span><br><span class="line">    D2 = []</span><br><span class="line">    D3 = []</span><br><span class="line">    D = []</span><br><span class="line">    <span class="comment"># 求导</span></span><br><span class="line">    a= sp.symbols(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    b = <span class="number">1</span>/(<span class="number">1</span>+a**<span class="number">2</span>)</span><br><span class="line">    db = sp.diff(b,a)</span><br><span class="line">    <span class="comment"># 系数矩阵</span></span><br><span class="line">    mu = []</span><br><span class="line">    lmda = []</span><br><span class="line">    A = np.zeros((L,L))</span><br><span class="line">    mu.append(<span class="number">0</span>)                <span class="comment">#补0</span></span><br><span class="line">    lmda.append(<span class="number">0</span>)              <span class="comment">#补0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        <span class="keyword">if</span> i == n-<span class="number">1</span>:            <span class="comment">#周期样条改这里</span></span><br><span class="line">            mu.append(<span class="number">0</span>)</span><br><span class="line">            lmda.append(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        mu.append(H[i]/(H[i]+H[i+<span class="number">1</span>]))</span><br><span class="line">        lmda.append(H[i+<span class="number">1</span>]/(H[i]+H[i+<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> :</span><br><span class="line">            A[i][i+<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            A[i][i] = <span class="number">2</span></span><br><span class="line">        <span class="keyword">elif</span> i == L-<span class="number">1</span> :</span><br><span class="line">            A[i][i-<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">            A[i][i] = <span class="number">2</span></span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            A[i][i] = <span class="number">2</span></span><br><span class="line">            A[i][i-<span class="number">1</span>] = mu[i]</span><br><span class="line">            A[i][i+<span class="number">1</span>] = lmda[i]</span><br><span class="line">    A = np.matrix(A)</span><br><span class="line">    <span class="comment"># 边界条件</span></span><br><span class="line">    D2 = divided_difference(X,Y,L,<span class="number">1</span>) <span class="comment"># 固支边界条件需要的2阶差商</span></span><br><span class="line">    D3 = divided_difference(X,Y,L,<span class="number">2</span>) <span class="comment"># 方程组右边向量</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>) :</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            D.append(<span class="number">6</span>/H[<span class="number">0</span>]*(D2[<span class="number">0</span>]-db.evalf(subs=&#123;a:-<span class="number">5</span>&#125;)))</span><br><span class="line">        <span class="keyword">elif</span> i&lt;n <span class="keyword">and</span> i&gt;<span class="number">0</span> :</span><br><span class="line">            D.append(<span class="number">6</span>*D3[i-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            D.append(<span class="number">6</span>/H[n-<span class="number">1</span>]*(db.evalf(subs=&#123;a:<span class="number">5</span>&#125;)-D2[-<span class="number">1</span>]))</span><br><span class="line">    D = np.array(D)</span><br><span class="line">    M = A.I.dot(D)</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="comment"># 样条插值函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spline_func</span>(<span class="params">xx,X,Y,H,M,n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        <span class="keyword">if</span> xx &lt;X[i+<span class="number">1</span>] <span class="keyword">and</span> xx &gt;=X[i]:</span><br><span class="line">            k = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    i = k</span><br><span class="line">    <span class="comment">#yy = pow((X[i+1]-xx),3)*M[0][i]/(6*H[i])+pow((xx-X[i]),3)*M[0][i+1]/(6*H[i])+(Y[i]-M[i]*H[i]*H[i]/6)*(X[i+1]-xx)/H[i]+(Y[i+1]-M[i+1]*H[i]*H[i]/6)*(xx-X[i])/H[i]</span></span><br><span class="line">    yy = <span class="built_in">pow</span>((X[i+<span class="number">1</span>]-xx),<span class="number">3</span>)*M[<span class="number">0</span>,i]/(<span class="number">6</span>*H[i])+<span class="built_in">pow</span>((xx-X[i]),<span class="number">3</span>)*M[<span class="number">0</span>,i+<span class="number">1</span>]/(<span class="number">6</span>*H[i])+(Y[i]-M[<span class="number">0</span>,i]*H[i]*H[i]/<span class="number">6</span>)*(X[i+<span class="number">1</span>]-xx)/H[i]+(Y[i+<span class="number">1</span>]-M[<span class="number">0</span>,i+<span class="number">1</span>]*H[i]*H[i]/<span class="number">6</span>)*(xx-X[i])/H[i]</span><br><span class="line">    <span class="keyword">return</span> yy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">10</span></span><br><span class="line">h = <span class="number">10</span>/n </span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line">H = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    X.append(-<span class="number">5</span>+i*h)            <span class="comment"># 插值节点</span></span><br><span class="line">    Y.append(func(X[i]))        <span class="comment"># 节点函数值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">    H.append(X[i+<span class="number">1</span>]-X[i])       <span class="comment"># 区间长度</span></span><br><span class="line">L = <span class="built_in">len</span>(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 样条插值函数</span></span><br><span class="line">x = np.arange(-<span class="number">5</span>,<span class="number">5.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">YY = []</span><br><span class="line">M = M(X,Y,H,L,n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> xx <span class="keyword">in</span> x:</span><br><span class="line">    yy = spline_func(xx,X,Y,H,M,n)</span><br><span class="line">    YY.append(yy)</span><br><span class="line">plt.plot(x, YY)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 比较图</span></span><br><span class="line">plt.plot(x, func(x))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure> <strong>输出结果:</strong> <img
src="/images/数值逼近/2b068357d9b7229211f5baf9e8ace574.png"
alt="2b068357d9b7229211f5baf9e8ace574.png" /></p>
<h1 id="练习三-物体运动轨迹"><a href="#练习三-(物体运动轨迹)" class="headerlink" title="练习三-(物体运动轨迹)"></a>练习三 (物体运动轨迹)</h1>
<p>(1)分段线性插值 <strong>代码:</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 物体的轨迹</span></span><br><span class="line"><span class="comment"># 分段线性插值</span></span><br><span class="line">T = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">X = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>]</span><br><span class="line">Y = [<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">n = <span class="built_in">len</span>(T)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段插值函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">piecewise_linear_interpolation_func</span>(<span class="params">xx,X,Y,n</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + basis_func(xx,X,i)*Y[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 基函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">basis_func</span>(<span class="params">xx,X,i</span>):</span><br><span class="line">    <span class="keyword">if</span> i==<span class="number">0</span> <span class="keyword">and</span> i == n:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i-<span class="number">1</span>] <span class="keyword">and</span> xx&lt;=X[i]:</span><br><span class="line">        l = (xx-X[i-<span class="number">1</span>])/(X[i]-X[i-<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">elif</span> xx&gt;=X[i] <span class="keyword">and</span> xx&lt;=X[i+<span class="number">1</span>]:</span><br><span class="line">        l = (xx-X[i+<span class="number">1</span>])/(X[i]-X[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> l</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分段插值图</span></span><br><span class="line">tt = numpy.arange(<span class="number">0</span>,<span class="number">4.1</span>,<span class="number">0.1</span>,<span class="built_in">float</span>)</span><br><span class="line">xx = []</span><br><span class="line">yy = []</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tt:</span><br><span class="line">    x = piecewise_linear_interpolation_func(t,T,X,n)</span><br><span class="line">    xx.append(x)</span><br><span class="line">    y = piecewise_linear_interpolation_func(t,T,Y,n)</span><br><span class="line">    yy.append(y)</span><br><span class="line"><span class="built_in">print</span>(xx,yy)</span><br><span class="line">plt.plot(xx,yy)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<strong>输出结果:</strong> <img
src="/images/数值逼近/79e1d4cb619e3a00ca97747343c640d7.png"
alt="79e1d4cb619e3a00ca97747343c640d7.png" /></p>
<p>(2)三次周期样条插值 <strong>代码：</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 物体的轨迹</span></span><br><span class="line"><span class="comment"># 三次 (周期) 样条插值方法</span></span><br><span class="line">T = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line">X = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">0</span>]</span><br><span class="line">H = [<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">Y = [<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">0</span>]</span><br><span class="line">n = <span class="built_in">len</span>(T)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> matplotlib <span class="keyword">import</span> pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"></span><br><span class="line"><span class="comment"># 差商表</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">divided_difference</span>(<span class="params">X,Y,l,k</span>):</span><br><span class="line">    N_k1 = deepcopy(Y)</span><br><span class="line">    N_k2 = deepcopy(Y)</span><br><span class="line">    N_k3 = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,k+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(j,l):</span><br><span class="line">            N_k2[i] = (N_k1[i]-N_k1[i-<span class="number">1</span>])/(X[i]-X[i-j])</span><br><span class="line">        N_k1 = deepcopy(N_k2)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k,l):</span><br><span class="line">        N_k3.append(N_k1[j])</span><br><span class="line">    <span class="keyword">return</span> N_k3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 三弯矩计算M</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">M</span>(<span class="params">X,Y,H,L,n</span>):</span><br><span class="line">    M = []</span><br><span class="line">    D2 = []</span><br><span class="line">    D3 = []</span><br><span class="line">    D = []</span><br><span class="line">    <span class="comment"># 系数矩阵</span></span><br><span class="line">    D2 = divided_difference(X,Y,L,<span class="number">1</span>) <span class="comment"># 固支边界条件需要的1阶差商</span></span><br><span class="line">    D3 = divided_difference(X,Y,L,<span class="number">2</span>) <span class="comment"># 方程组右边向量</span></span><br><span class="line">    mu = []</span><br><span class="line">    lmda = []</span><br><span class="line">    A = np.zeros((L-<span class="number">1</span>,L-<span class="number">1</span>))</span><br><span class="line">    mu.append(<span class="number">0</span>)                <span class="comment">#补0</span></span><br><span class="line">    lmda.append(<span class="number">0</span>)              <span class="comment">#补0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        <span class="keyword">if</span> i == n-<span class="number">1</span>:            <span class="comment">#周期样条改这里</span></span><br><span class="line">            mu.append(<span class="number">1</span>/<span class="number">2</span>)</span><br><span class="line">            lmda.append(<span class="number">1</span>/<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        mu.append(H[i]/(H[i]+H[i+<span class="number">1</span>]))</span><br><span class="line">        lmda.append(H[i+<span class="number">1</span>]/(H[i]+H[i+<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> :</span><br><span class="line">            A[i][i+<span class="number">1</span>] = lmda[<span class="number">1</span>]</span><br><span class="line">            A[i][i] = <span class="number">2</span></span><br><span class="line">            A[i][-<span class="number">1</span>] = mu[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> i == n-<span class="number">1</span> :</span><br><span class="line">            A[i][-<span class="number">2</span>] = mu[i+<span class="number">1</span>]</span><br><span class="line">            A[i][-<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">            A[i][<span class="number">0</span>] = lmda[i+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span> :</span><br><span class="line">            A[i][i] = <span class="number">2</span></span><br><span class="line">            A[i][i-<span class="number">1</span>] = mu[i+<span class="number">1</span>]</span><br><span class="line">            A[i][i+<span class="number">1</span>] = lmda[i+<span class="number">1</span>]</span><br><span class="line">    A = np.matrix(A)</span><br><span class="line">    <span class="comment"># 边界条件</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(D3)) :</span><br><span class="line">        D.append(<span class="number">6</span>*D3[i])</span><br><span class="line">    D.append(<span class="number">3</span>*(D2[<span class="number">0</span>]-D2[-<span class="number">1</span>]))</span><br><span class="line">    <span class="built_in">print</span>(D)</span><br><span class="line">    D = np.array(D)</span><br><span class="line">    M = A.I.dot(D)</span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="comment"># 样条插值函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">spline_func</span>(<span class="params">xx,X,Y,H,M,n</span>):</span><br><span class="line">    k = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n):</span><br><span class="line">        <span class="keyword">if</span> xx &lt;=X[i+<span class="number">1</span>] <span class="keyword">and</span> xx &gt;=X[i]:</span><br><span class="line">            k = i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    i = k</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        yy = <span class="built_in">pow</span>((X[i+<span class="number">1</span>]-xx),<span class="number">3</span>)*M[<span class="number">0</span>,-<span class="number">1</span>]/(<span class="number">6</span>*H[i])+<span class="built_in">pow</span>((xx-X[i]),<span class="number">3</span>)*M[<span class="number">0</span>,<span class="number">0</span>]/(<span class="number">6</span>*H[i])+(Y[i]-M[<span class="number">0</span>,-<span class="number">1</span>]*H[i]*H[i]/<span class="number">6</span>)*(X[i+<span class="number">1</span>]-xx)/H[i]+(Y[i+<span class="number">1</span>]-M[<span class="number">0</span>,<span class="number">0</span>]*H[i]*H[i]/<span class="number">6</span>)*(xx-X[i])/H[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        yy = <span class="built_in">pow</span>((X[i+<span class="number">1</span>]-xx),<span class="number">3</span>)*M[<span class="number">0</span>,i-<span class="number">1</span>]/(<span class="number">6</span>*H[i])+<span class="built_in">pow</span>((xx-X[i]),<span class="number">3</span>)*M[<span class="number">0</span>,i]/(<span class="number">6</span>*H[i])+(Y[i]-M[<span class="number">0</span>,i-<span class="number">1</span>]*H[i]*H[i]/<span class="number">6</span>)*(X[i+<span class="number">1</span>]-xx)/H[i]+(Y[i+<span class="number">1</span>]-M[<span class="number">0</span>,i]*H[i]*H[i]/<span class="number">6</span>)*(xx-X[i])/H[i]</span><br><span class="line">    <span class="keyword">return</span> yy</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 作插值图</span></span><br><span class="line">tt = np.arange(<span class="number">0</span>,<span class="number">4.01</span>,<span class="number">0.01</span>,<span class="built_in">float</span>)</span><br><span class="line">xx = []</span><br><span class="line">yy = []</span><br><span class="line">M1 = M(T,X,H,n+<span class="number">1</span>,n)</span><br><span class="line">M2 = M(T,Y,H,n+<span class="number">1</span>,n)</span><br><span class="line"><span class="built_in">print</span>(M1)</span><br><span class="line"><span class="comment"># M1 = [[3,-6,-3,6]]</span></span><br><span class="line"><span class="comment"># M2 = [[1.5,-9,4.5,3]]</span></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> tt:</span><br><span class="line">    x = spline_func(t,T,X,H,M1,n)</span><br><span class="line">    xx.append(x)</span><br><span class="line">    y = spline_func(t,T,Y,H,M2,n)</span><br><span class="line">    yy.append(y)</span><br><span class="line">plt.plot(xx,yy)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<strong>输出结果：</strong> <img
src="/images/数值逼近/759e51309762f1feb4dc0969f9b84404.png"
alt="759e51309762f1feb4dc0969f9b84404.png" /></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2022/10/18/%E6%9B%B2%E7%BA%BF%E6%9B%B2%E9%9D%A2%E7%9A%84%E6%8B%9F%E5%90%88/">← Next 曲线曲面的拟合</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2022/10/11/%E6%8F%92%E5%80%BC%E6%96%B9%E6%B3%95%EF%BC%88%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%8F%92%E5%80%BC%EF%BC%89/">插值方法（多项式插值） Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="回到顶部" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="文章目录">≡</a><a id="color-mode" onClick="colorMode.change()" title="切换主题"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">BriChen</a></h1><div id="description"><p></p></div></div><div id="aside-block"><div id="toc-div"><h1>目录</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E4%B8%80-runge%E7%8E%B0%E8%B1%A1"><span class="toc-number">1.</span> <span class="toc-text">练习一 (Runge现象)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%83%E4%B9%A0%E4%B8%89-%E7%89%A9%E4%BD%93%E8%BF%90%E5%8A%A8%E8%BD%A8%E8%BF%B9"><span class="toc-number">2.</span> <span class="toc-text">练习三 (物体运动轨迹)</span></a></li></ol></div></div><footer><nobr>构建自 <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> 使用主题 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>主题作者 <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>